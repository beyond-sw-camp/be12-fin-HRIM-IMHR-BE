apiVersion: batch/v1
kind: CronJob
metadata:
  name: member-batch-job
  namespace: imhr
spec:
  schedule: "1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59 * * * *"
  startingDeadlineSeconds: 200  # ⬅️ 잡이 실행되지 못할 경우 허용 대기 시간 (선택)
  concurrencyPolicy: Forbid     # ⬅️ 이전 실행이 끝나지 않으면 중복 실행 금지
  successfulJobsHistoryLimit: 3 # ⬅️ 완료된 잡 기록 수 제한
  failedJobsHistoryLimit: 1     # ⬅️ 실패한 잡 기록 수 제한
  jobTemplate:
    spec:
      backoffLimit: 2
      template:
        spec:
          restartPolicy: OnFailure
          containers:
            - name: member-batch
              image: imhrkr/batch-api:1.37
              env:
                - name: BATCH_JOB_NAME
                  value: memberJob
              envFrom:
                - configMapRef:
                    name: back-cm
